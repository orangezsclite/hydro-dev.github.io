(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{528:function(s,t,a){"use strict";a.r(t);var r=a(2),e=Object(r.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"migrate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#migrate"}},[s._v("#")]),s._v(" migrate")]),s._v(" "),a("h2",{attrs:{id:"从-hustoj-升级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从-hustoj-升级"}},[s._v("#")]),s._v(" 从 HUSTOJ 升级")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("Note")]),s._v(" "),a("p",[s._v("迁移会删除当前 Hydro 的所有数据（含用户账户信息）并移入 HUSTOJ 的数据。"),a("br"),s._v("\n请注意备份相关文件。")])]),s._v(" "),a("p",[s._v("请先完成 Hydro 的部署并完成对文件服务的配置(setting_file)。\n在迁移数据之前，请先停止正在运行的 HUSTOJ 服务，仅保留其数据库开启。\n请注意 Hydro 所在的数据库不应和源 HUSTOJ 数据库相同。")]),s._v(" "),a("p",[s._v("安装插件后，您应当能够在 控制面板>脚本管理 中找到名为 "),a("code",[s._v("migrateHustoj")]),s._v(" 的脚本。\n其参数格式如下：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jol"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"domainId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"system"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"contestType"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dataDir"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("host: 数据库地址")]),s._v(" "),a("li",[s._v("port: 数据库端口")]),s._v(" "),a("li",[s._v("name: 数据库名，一般为 "),a("code",[s._v("jol")])]),s._v(" "),a("li",[s._v("username&password: 账号密码，若无则填写空字符串")]),s._v(" "),a("li",[s._v("domainId: 迁入的域，默认为 "),a("code",[s._v("system")])]),s._v(" "),a("li",[s._v("contestType: "),a("code",[s._v("oi")]),s._v(" 或者 "),a("code",[s._v("acm")]),s._v("，视情况而定")]),s._v(" "),a("li",[s._v("dataDir: HUSTOJ 中 data 文件夹的位置（这里存储着题目数据等关键信息，需要手动处理）")])]),s._v(" "),a("p",[s._v("当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。\n迁移后，请使用原 HUSTOJ 的管理员账号登录实例。")]),s._v(" "),a("h2",{attrs:{id:"从-syzoj-升级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从-syzoj-升级"}},[s._v("#")]),s._v(" 从 SYZOJ 升级")]),s._v(" "),a("p",[s._v("SYZOJ 与 HUSTOJ 迁移方法类似，迁移脚本应运行名为 "),a("code",[s._v("migrateSyzoj")]),s._v(" 的脚本外，SYZOJ无需 "),a("code",[s._v("contestType")]),s._v(" 参数。\n其参数格式如下：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"syzoj"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"domainId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"system"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dataDir"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("host: 数据库地址")]),s._v(" "),a("li",[s._v("port: 数据库端口")]),s._v(" "),a("li",[s._v("name: 数据库名，一般为 "),a("code",[s._v("syzoj")])]),s._v(" "),a("li",[s._v("username&password: 账号密码，若无则填写空字符串")]),s._v(" "),a("li",[s._v("domainId: 迁入的域，默认为 "),a("code",[s._v("system")])]),s._v(" "),a("li",[s._v("dataDir: SYZOJ 中 data 文件夹的位置（这里存储着题目数据等关键信息，需要手动处理）")])]),s._v(" "),a("p",[s._v("由于SYZOJ脚本会将原站所有数据迁移，所以运行耗时较长。\n当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。\n迁移后，请使用原 SYZOJ 的管理员账号登录实例。")]),s._v(" "),a("h2",{attrs:{id:"从-vijos-升级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从-vijos-升级"}},[s._v("#")]),s._v(" 从 Vijos 升级")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("Note")]),s._v(" "),a("p",[s._v("迁移会删除当前 Hydro 的所有数据（含用户账户信息）并移入 vj4 的数据。"),a("br"),s._v("\n请注意备份相关文件。")])]),s._v(" "),a("p",[s._v("请先完成 Hydro 的部署并完成对文件服务的配置(setting_file)。"),a("br"),s._v("\n在迁移数据之前，请先停止正在运行的 vj4 服务，仅保留其数据库开启。"),a("br"),s._v("\n请注意 Hydro 所在的数据库不应和源 vj4 数据库相同。"),a("br"),s._v("\n若您使用 vj4-docker ，可更改 "),a("code",[s._v("docker-compose.yml")]),s._v(" 将数据库映射至其他本机端口。")]),s._v(" "),a("p",[s._v("安装插件后，您应当能够在 控制面板>脚本管理 中找到名为 "),a("code",[s._v("migrateVijos")]),s._v(" 的脚本。"),a("br"),s._v("\n其参数格式如下：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vj4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("host: 数据库地址")]),s._v(" "),a("li",[s._v("port: 数据库端口")]),s._v(" "),a("li",[s._v("name: 数据库名")]),s._v(" "),a("li",[s._v("username&password: 账号密码，若无则填写空字符串")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("Tips")]),s._v(" "),a("p",[s._v("vj4-docker 中数据库名为 vj4，无账号密码。")])]),s._v(" "),a("p",[s._v("当脚本运行完成后，请重启 Hydro 实例，会自动完成之后的升级操作。\n迁移后，请使用原 vj4 的管理员账号登录实例。")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("Note")]),s._v(" "),a("p",[s._v("若您的 vj4 是由 vj2 或 tyvj 升级而来，在迁移完成后请不要卸载该插件，否则可能导致部分用户无法登录。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);